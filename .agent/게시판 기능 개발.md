# 게시판 기능 개발 계획서 (내일 개발 예정)

본 문서는 VIMS 시스템 내 메뉴별 게시판 기능 개발을 위한 상세 설계 및 절차를 정리한 문서입니다. 특히 파일 업로드/다운로드와 메뉴 정보 매핑 전략을 중점적으로 다룹니다.

---

## 1. 개발 목표
*   사용자가 메뉴별 상세 페이지에서 파일을 업로드하고 다운로드할 수 있는 게시판(또는 정보 관리) 기능 구현.
*   업로드된 파일이 어떤 메뉴와 연관되어 있는지 명확하게 관리하여 향후 통계 및 통합 조회 지원.

---

## 2. 데이터베이스 연동 전략 (핵심)

### 2.1 파일-메뉴 매핑 방식 선택
*   **선택된 방식**: `SYS_MENU` 테이블의 **`menu_code`**를 `SYS_FILE_DETAIL` 테이블의 `menu_code` 컬럼에 직접 저장하는 방식.
*   **선정 이유**:
    - **정합성**: DB Primary Key 수준의 식별자를 사용하여 데이터 관계가 고정적이고 안전함.
    - **유지보수**: 프로그램 식별자(`PRGMID`)는 소스 코드 수정에 취약하나, `menu_code`는 시스템 관리자가 제어하므로 데이터 영속성이 높음.
    - **통합 조회**: 사용자가 자신이 올린 모든 파일을 볼 때, `SYS_MENU`와 JOIN하여 어떤 메뉴의 파일인지 즉시 표시 가능.

### 2.2 추천 데이터 흐름
1.  **게시글 등록**: 
    - 게시판 데이터(제목, 내용 등) 저장 시, FMS 전용 UUID 하나를 생성하여 업무 테이블에 보관.
2.  **파일 연동**:
    - `SYS_FILE_DETAIL`에 파일 정보를 넣을 때, 현재 화면의 `menu_code`를 함께 저장.
3.  **조회 및 다운로드**:
    - 상세 페이지 진입 시 업무 데이터의 UUID로 파일 목록을 가져오되, 필요시 `menu_code`로 필터링하여 해당 메뉴 전용 고정 파일(매뉴얼 등)을 함께 출력.

---

## 3. 내일 수행할 개발 단계

### [Step 1] DB 스키마 확인 및 생성
*   게시판 기능을 담당할 업무용 테이블(예: `TB_BOARD`) 생성 (필요 시).
*   `SYS_FILE_DETAIL` 테이블의 `menu_code` 컬럼 활용 가능 여부 최종 확인.

### [Step 2] 백엔드 구현 (FMS & Management)
*   **FMS 서버**: 특정 `menu_code`로 업로드된 파일을 조회하는 API 개발 (MyBatis 사용).
*   **Management 서버**: 게시판 CRUD 로직 개발 및 Feign Client를 통한 파일 연동.
*   **중요**: JPA 대신 MyBatis를 사용하여 대문자 테이블(`SYS_FILE_DETAIL`) 매핑 시 `@Table` 어노테이션 의존성 최소화.

### [Step 3] 프론트엔드 UI 개발
*   `FileUtils.js`의 `createFileUpload` 함수를 사용하여 업로드 UI 연동.
*   상세 페이지 로드 시 현재 메뉴의 `menu_code`를 파라미터로 하여 파일 목록 API 호출.
*   그리드 또는 리스트 형태로 다운로드 링크 제공.

---

## 4. 사전 체크리스트 및 보안
*   **API-Key**: 마이크로서비스 간 통신 시 `X-Internal-API-Key`가 정상적으로 전달되는가?
*   **인증**: Postman 또는 외부 호출 시 `Authorization` 헤더(Bearer 토큰)가 누락되지 않도록 주의.
*   **감사로그**: 게시글 등록/수정 시 `EventLogInterceptor`에 의해 로그가 정상 기록되는지 확인.

---

**내일 오전 중으로 Step 1부터 순차적으로 진행할 예정입니다.**
